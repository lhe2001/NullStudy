<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="mapper.mystudy">
<!-- 		테이블이름 칼럼 맞는지 확인하기!!! -->

<!-- 메모리스트 -->
	<select id="Paging_list" resultType="memoDTO" parameterType="memoDTO">
      <![CDATA[
		 SELECT * from(
			 select rownum rnum, tmp.* from ( 
			 select * from mymemo
			 where userkey = #{userkey} 
			 order by m_memo_date desc) tmp
		)
		WHERE #{startIdx} <= rnum AND rnum <= #{endIdx}
		order by m_memo_date desc
      ]]>
	</select>
	
<!-- 메모 전체 목록 수-->
	<select id="Paging_allCnt" resultType="int">
      <![CDATA[
		select count(*) 
		from mymemo
		where userkey = #{userkey}
      ]]>
	</select>
	
<!-- 	메모 작성하기 -->
	<insert id="insertMemo" parameterType="memoDTO">
		<![CDATA[
		 insert into mymemo(m_memo_key, userkey, m_memo_title, m_memo_desc, m_memo_date )
		 values(seq_mymemo.nextval, #{userkey}, #{m_memo_title}, #{m_memo_desc}, sysdate)
		]]>      
	</insert>
	
<!-- 	메모 수정 전 해당dto조회 -->
	<select id="selectOneMemo" resultType="memoDTO" parameterType="int">
      <![CDATA[
         select * from mymemo	
         where m_memo_key = #{m_memo_key}	 	
      ]]>
	</select>
		
<!-- 	메모 수정하기 -->
	<update id="updateMemo" parameterType="memoDTO">
		<![CDATA[
		 update mymemo
		 set m_memo_title = #{m_memo_title}
		 	,m_memo_desc = #{m_memo_desc}
		 	where m_memo_key = #{m_memo_key}
		]]> 
	</update>

<!-- 	메모 삭제하기 -->
	<delete id="deleteMemo" parameterType="int">
		<![CDATA[
		delete from mymemo
		where m_memo_key = #{m_memo_key}
		]]>
	</delete>
	
<!-- 일정 추가하기 -->
	<insert id="insertSchedule" parameterType="scheduleDTO">
		<![CDATA[
		 insert into myschedule(m_schedule_key, userkey, m_schedule_title, m_schedule_desc, m_schedule_date )
		 values(seq_myschedule.nextval, #{userkey}, #{m_schedule_title}, #{m_schedule_desc}, #{m_schedule_date})
		]]>      
	</insert>

<!-- 일정 조회하기 -->
	<select id="selectMonthList" resultType="scheduleDTO" parameterType="scheduleDTO">
      <![CDATA[
         select *
         from myschedule
         where userkey = #{userkey} and to_char(m_schedule_date, 'yyyy-MM')	= #{m_schedule_date} 	
      ]]>
	</select>

	
	
	
	
</mapper>